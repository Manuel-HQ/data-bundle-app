<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Wallet</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='wallet.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='header.css') }}">
</head>
<body>
  <header class="site-header">
    <div class="logo">ğŸ“¶ Manuel Data</div>
    <nav class="nav">
      <a href="{{ url_for('dashboard') }}">ğŸ  Home</a>
      <a href="{{ url_for('purchase') }}">ğŸ’³ Buy Data</a>
      <a href="{{ url_for('profile') }}">ğŸ‘¤ Profile</a>
      <a href="{{ url_for('wallet') }}">ğŸ’° Wallet</a>
      <a href="{{ url_for('faq') }}">â“ FAQ</a>
      <a href="{{ url_for('contact') }}">ğŸ“ Contact</a>
      <a href="{{ url_for('logout') }}" class="login-btn">ğŸšª Logout</a>
    </nav>
    <div class="hamburger" onclick="openNav()">â˜°</div>
  </header>

  <!-- Mobile Nav -->
  <div id="mobileNav" class="overlay-nav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">Ã—</a>
    <div class="overlay-content">
      <a href="{{ url_for('dashboard') }}">ğŸ  Home</a>
      <a href="{{ url_for('purchase') }}">ğŸ’³ Buy Data</a>
      <a href="{{ url_for('profile') }}">ğŸ‘¤ Profile</a>
      <a href="{{ url_for('wallet') }}">ğŸ’° Wallet</a>
      <a href="{{ url_for('faq') }}">â“ FAQ</a>
      <a href="{{ url_for('contact') }}">ğŸ“ Contact</a>
      <a href="{{ url_for('logout') }}" class="login-btn">ğŸšª Logout</a>
    </div>
  </div>

  <!-- Wallet Section -->
  <div class="wallet-container">
    <h2>ğŸ’° Wallet Balance: <span>GHS {{ '%.2f' | format(user['wallet_balance']) }}</span></h2>

    <form id="topUpForm" method="POST" action="{{ url_for('initiate_payment') }}" class="wallet-form">
      <div class="form-group">
        <label for="amount">ğŸ’µ Amount</label>
        <input type="number" name="amount" id="amount" placeholder="Enter amount" step="0.01" required>
      </div>

      <div class="form-group">
        <label for="provider">ğŸ“¡ Provider</label>
        <select name="provider" id="provider" required>
          <option value="">-- Select Provider --</option>
          <option value="MTN">MTN</option>
          <option value="Vodafone">Vodafone</option>
          <option value="AirtelTigo">AirtelTigo</option>
        </select>
      </div>

      <div class="form-group">
        <label for="number">ğŸ“± Mobile Number</label>
        <input type="text" name="number" id="number" placeholder="e.g. 0551234567" required>
      </div>

      <button type="button" class="btn-primary" onclick="showConfirmation()">âš¡ Top Up</button>
    </form>

    <a href="{{ url_for('dashboard') }}" class="back-link">â† Back to Dashboard</a>
  </div>

  <!-- Modal -->
  <div id="confirmationModal" class="modal">
    <div class="modal-content">
      <h3>ğŸ”” Confirm Top-Up</h3>
      <p id="confirmText"></p>
      <div class="modal-buttons">
        <button onclick="submitForm()" class="btn-primary">âœ… Confirm</button>
        <button onclick="closeModal()" class="btn-ghost">âŒ Cancel</button>
      </div>
    </div>
  </div>

  <script>
    function showConfirmation() {
      const amount = document.getElementById('amount').value;
      const provider = document.getElementById('provider').value;
      const number = document.getElementById('number').value;

      if (!amount || !provider || !number) {
        alert("âš ï¸ Please fill out all fields.");
        return;
      }

      const confirmText = `ğŸ’µ Amount: GHS ${amount}<br>ğŸ“¡ Provider: ${provider}<br>ğŸ“± Number: ${number}`;
      document.getElementById('confirmText').innerHTML = confirmText;
      document.getElementById('confirmationModal').style.display = 'flex';
    }

    function closeModal() {
      document.getElementById('confirmationModal').style.display = 'none';
    }

    function submitForm() {
      document.getElementById('topUpForm').submit();
    }

    function openNav() {
      document.getElementById("mobileNav").style.width = "100%";
    }

    function closeNav() {
      document.getElementById("mobileNav").style.width = "0%";
    }
  </script>
</body>
</html>
