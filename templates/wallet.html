<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Wallet</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='wallet.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='header.css') }}">
</head>
<body>
  <header class="site-header">
    <div class="logo">üì∂ Manuel Data</div>
    <nav class="nav">
  <a href="{{ url_for('dashboard') }}">Home</a>
  <a href="{{ url_for('purchase') }}">Buy Data</a>
  <a href="{{ url_for('profile') }}">Profile</a>
  <a href="{{ url_for('wallet') }}">Wallet</a>
  <a href="{{ url_for('faq') }}">FAQ</a>

  <a href="{{ url_for('contact') }}">Contact</a>
  <a href="{{ url_for('logout') }}" class="login-btn">Logout</a>
</nav>
<div class="hamburger" onclick="openNav()">‚ò∞</div>

  </header>
    <div id="mobileNav" class="overlay-nav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">√ó</a>
    <div class="overlay-content">
      <a href="{{ url_for('dashboard') }}">Home</a>
  <a href="{{ url_for('purchase') }}">Buy Data</a>
  <a href="{{ url_for('profile') }}">Profile</a>
  <a href="{{ url_for('wallet') }}">Wallet</a>
  <a href="{{ url_for('faq') }}">FAQ</a>

  <a href="{{ url_for('contact') }}">Contact</a>
  <a href="{{ url_for('logout') }}" class="login-btn">Logout</a>
    </div>
  </div>
  <div class="wallet-container">
    <h2>Wallet Balance: GHS {{ '%.2f' | format(user['wallet_balance']) }}</h2>

    <!-- FIXED: Send to initiate_payment -->
    <form id="topUpForm" method="POST" action="{{ url_for('initiate_payment') }}">
      <input type="number" name="amount" id="amount" placeholder="Amount to top-up" step="0.01" required>
      <select name="provider" id="provider" required>
        <option value="">Select Provider</option>
        <option value="MTN">MTN</option>
        <option value="Vodafone">Vodafone</option>
        <option value="AirtelTigo">AirtelTigo</option>
      </select>
      <input type="text" name="number" id="number" placeholder="Mobile Number" required>
      <button type="button" onclick="showConfirmation()">Top Up</button>
    </form>

    <a href="{{ url_for('dashboard') }}">‚Üê Back to Dashboard</a>
  </div>

  <!-- Modal -->
  <div id="confirmationModal" class="modal">
    <div class="modal-content">
      <h3>Confirm Top-Up</h3>
      <p id="confirmText"></p>
      <div class="modal-buttons">
        <button onclick="submitForm()">Confirm</button>
        <button onclick="closeModal()">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    function showConfirmation() {
      const amount = document.getElementById('amount').value;
      const provider = document.getElementById('provider').value;
      const number = document.getElementById('number').value;

      if (!amount || !provider || !number) {
        alert("Please fill out all fields.");
        return;
      }

      const confirmText = `Amount: GHS ${amount}<br>Provider: ${provider}<br>Mobile Number: ${number}`;
      document.getElementById('confirmText').innerHTML = confirmText;
      document.getElementById('confirmationModal').style.display = 'block';
    }

    function closeModal() {
      document.getElementById('confirmationModal').style.display = 'none';
    }

    function submitForm() {
      document.getElementById('topUpForm').submit();
    }
    function openNav() {
      document.getElementById("mobileNav").style.width = "100%";
    }

    function closeNav() {
      document.getElementById("mobileNav").style.width = "0%";
    }
  </script>
</body>
</html>
